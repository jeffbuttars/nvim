#!/bin/bash

source pkgs.sh
source nvimenv.sh
source in_up.sh

pr_info "Vim Plug?"
if [[ ! -f "$NVIM_HOME/autoload/plug.vim" ]]; then
    pr_info "Installing Vim Plug."
    curl -fLo "$NVIM_HOME/autoload/plug.vim" --create-dirs \
        https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi

export THIS_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

pr_info "Creating the new ${NVIM_INIT}"
export PKGS_NVIM_DIR="$(dirname $THIS_DIR/)/nvim"
echo "set runtimepath+=$PKGS_NVIM_DIR" > "$NVIM_INIT"
echo "source $PKGS_NVIM_DIR/init.vim" >> "$NVIM_INIT"
echo "source $PKGS_NVIM_DIR/ginit.vim" >> "${NVIM_GINIT}"

source buildycm.sh
wait

pr_info "Updating plugs..."
nvim +PlugInstall +UpdateRemotePlugins +qa
wait

# pr_info "Updating Remote Plugins..."
# nvim -c "UpdateRemotePlugins<\CR>" -c "qa!"
# wait

pr_info "Installing instant markdown via npm..."
npm -g install instant-markdown-d
wait

pr_pass "Install complete"
